<footer class="site-footer">
<!-- test -->
  <div class="container footer-inner footer-grid">

    <!-- Column 1: Explore -->
    <div class="footer-col footer-animate">
      <button class="footer-col-header" aria-expanded="false">
        <svg class="footer-header-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" preserveAspectRatio="xMidYMid meet" width="20" height="20">
          <path d="M3 6H21" />
          <path d="M3 12H21" />
          <path d="M3 18H21" />
        </svg>
        <span class="orbitron">Explore</span>
        <span class="footer-accordion-arrow">▾</span>
      </button>
      <ul class="footer-links footer-col-content">
        <li><a href="/">Home</a></li>
        <li><a href="/products/">Products</a></li>
        <li><a href="/#why">Why BonnieByte</a></li>
        <li><a href="/#story">Our Story</a></li>
        <li><a href="/#notify">Updates</a></li>
      </ul>
    </div>

    <!-- Column 2: Tools -->
    <div class="footer-col footer-animate">
      <button class="footer-col-header" aria-expanded="false">
        <svg class="footer-header-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" preserveAspectRatio="xMidYMid meet" width="20" height="20">
          <path d="M12 2L12 6" />
          <path d="M12 18L12 22" />
          <circle cx="12" cy="12" r="4" />
        </svg>
        <span class="orbitron">Tools</span>
        <span class="footer-accordion-arrow">▾</span>
      </button>
      <ul class="footer-links footer-col-content">
        <li><a href="/tools/airflow/">Airflow Calculator</a></li>
      </ul>
    </div>

    <!-- Column 3: Legal -->
    <div class="footer-col footer-animate">
      <button class="footer-col-header" aria-expanded="false">
        <svg class="footer-header-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" preserveAspectRatio="xMidYMid meet" width="20" height="20">
          <path d="M12 3V6" />
          <path d="M8 6L5 12H11L8 6Z" />
          <path d="M16 6L13 12H19L16 6Z" />
          <path d="M12 6V21" />
        </svg>
        <span class="orbitron">Legal</span>
        <span class="footer-accordion-arrow">▾</span>
      </button>

      <ul class="footer-links footer-col-content">
        <li><a href="/legal/privacy-policy">Privacy Policy</a></li>
        <li><a href="/legal/cookie-policy">Cookie Policy</a></li>
        <li><a href="/legal/terms">Terms of Service</a></li>
        <li><a href="/legal/returns">Returns & Refunds</a></li>
        <li><a href="/legal/shipping">Shipping Policy</a></li>
        <li><a href="/warranty/">Warranty</a></li>
        <li><a href="/legal/cookie-policy#bbpc-reset-cookie-consent">Change Cookie Settings</a></li>
      </ul>
    </div>

    <!-- Column 4: Social -->
    <div class="footer-col footer-animate">
      <button class="footer-col-header" aria-expanded="false">
        <svg class="footer-header-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" preserveAspectRatio="xMidYMid meet" width="20" height="20">
          <circle cx="12" cy="12" r="9" />
        </svg>
        <span class="orbitron">Social</span>
        <span class="footer-accordion-arrow">▾</span>
      </button>

      <ul class="footer-links footer-col-content footer-social-vertical">
        <li>
          <a href="https://instagram.com/bonniebytepc" target="_blank">
            <svg class="footer-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" preserveAspectRatio="xMidYMid meet" width="20" height="20">
              <rect x="5" y="5" width="14" height="14" rx="4" />
              <circle cx="12" cy="12" r="3" />
              <circle cx="16.2" cy="7.8" r="0.9" />
            </svg>
            Instagram
          </a>
        </li>

        <li>
          <a href="https://tiktok.com/@bonniebytepc" target="_blank">
            <svg class="footer-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" preserveAspectRatio="xMidYMid meet" width="20" height="20">
              <path d="M10 4V14.5" />
              <circle cx="10" cy="17.5" r="2.5" />
              <path d="M10 6.5C12 9 15 9.5 17 9.5V4" />
            </svg>
            TikTok
          </a>
        </li>

        <li>
          <a href="https://twitter.com/bonniebytepc" target="_blank">
            <svg class="footer-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" preserveAspectRatio="xMidYMid meet" width="20" height="20">
              <defs>
                <clipPath id="bbx-hide">
                  <rect x="0" y="0" width="24" height="24"/>
                </clipPath>
                <mask id="bbx-main-stroke">
                  <rect width="24" height="24" fill="white"/>
                  <path d="M3 3 L11 3 L21 21 L13 21 Z" fill="black"/>
                </mask>
              </defs>
              <path d="M3 21 L21 3"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    mask="url(#bbx-main-stroke)" />
              <path d="M3 3 L11 3 L21 21 L13 21 Z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linejoin="round" />
            </svg>
            Twitter / X
          </a>
        </li>

        <li>
          <a href="https://facebook.com/bonniebytepc" target="_blank">
            <svg class="footer-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none" preserveAspectRatio="xMidYMid meet" width="20" height="20">
              <rect x="5" y="5" width="14" height="14" rx="3" />
              <path d="M13 8H11.5C10.4 8 9.5 8.9 9.5 10V16" />
              <path d="M10 12H13" />
            </svg>
            Facebook
          </a>
        </li>
      </ul>
    </div>

  </div>

  <div class="container footer-bottom">
    <div class="footer-brand">
      <source srcset="/images/LogoDetailTag.webp" type="image/webp">
      <img src="/images/LogoDetailTag.png" alt="BonnieByte PC" class="header-logo-img">
      <p class="footer-brand-text">
        Beautiful, high-performance PC cooling crafted with Scottish pride.
      </p>
    </div>

    <p>
      <strong>Email:</strong> <a href="mailto:hello@bonniebytepc.com">hello@bonniebytepc.com</a> &nbsp;|&nbsp;
      <strong>Support:</strong> <a href="mailto:support@bonniebytepc.com">support@bonniebytepc.com</a>
    </p>

    <p>&copy; <span id="footer-year"></span> <span class="orbitron">BonnieByte PC</span>. All rights reserved.</p>
  </div>

  <!-- FOOTER SCRIPTS (unchanged) -->
  <script>
    document.querySelectorAll(".footer-col-header").forEach(header => {
        header.setAttribute("type", "button");
    
        header.addEventListener("click", (ev) => {
            ev.preventDefault();
            ev.stopPropagation();
    
            const expanded = header.getAttribute("aria-expanded") === "true";
            const content = header.nextElementSibling;
    
            header.setAttribute("aria-expanded", !expanded);
    
            if (!expanded) {
                content.style.maxHeight = content.scrollHeight + "px";
            } else {
                content.style.maxHeight = "0px";
            }
        });
    });
  </script>
  
  <script>
      document.addEventListener("DOMContentLoaded", () => {
        const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT);
        let node;
      
        while (node = walker.nextNode()) {
          if (node.nodeValue.includes("BonnieByte PC")) {
            const span = document.createElement("span");
            span.className = "brand-name";
            span.textContent = "BonnieByte PC";
            node.parentNode.replaceChild(span, node);
          }
        }
      });
  </script>

<!-- ============================================================
     BONNIEBYTE PC — STABILITY-PATCHED SAFARI TRANSLATION ENGINE
=============================================================== -->

<!-- Google translate container -->
<div id="google_translate_element" style="position:absolute; left:-9999px; top:-9999px;"></div>
  
<div class="bb-image-modal" aria-hidden="true">
  <div class="bb-image-modal-backdrop"></div>
  <div class="bb-image-modal-content">
    <img src="" alt="" id="bb-image-modal-img">
  </div>
</div>

<script>
/* ---------- 1. Initialize widget ---------- */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
      pageLanguage: 'en',
      includedLanguages: 'en,gd,fr,de,es',
      autoDisplay: false
  }, 'google_translate_element');
}

/* ---------- 2. Hard iframe reset ---------- */
function resetTranslateIframe() {
    document.querySelectorAll("iframe.goog-te-menu-frame, iframe.goog-te-gadget")
      .forEach(f => f.remove());
}

/* ---------- 3. Reload Google script ---------- */
function reloadTranslateScript() {
    const old = document.querySelector('script[src*="translate.google.com"]');
    if (old) old.remove();

    const s = document.createElement("script");
    s.src = "//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit";
    s.async = true;
    document.head.appendChild(s);
}

/* ---------- 4. Safe translate wrapper ---------- */
function safeTranslate(lang) {
    if (!lang) return;

    let attempts = 0;
    const max = 50;
    let applied = false;

    function attempt() {
        attempts++;

        // Inline combo
        const combo = document.querySelector(".goog-te-combo");
        if (combo) {
            combo.value = lang;
            combo.dispatchEvent(new Event("change"));
            applied = true;
        }

        // Iframe combo
        const iframe = document.querySelector("iframe.goog-te-menu-frame");
        if (iframe) {
            try {
                const inner = iframe.contentDocument?.querySelector(".goog-te-combo");
                if (inner) {
                    inner.value = lang;
                    inner.dispatchEvent(new Event("change"));
                    applied = true;
                }
            } catch(e) {}
        }

        if (applied) {
            verifyTranslation(lang);
            return;
        }

        if (attempts < max) {
            return setTimeout(attempt, 100);
        }

        resetTranslateIframe();
        reloadTranslateScript();
        setTimeout(() => attempt(), 300);

        if (attempts > max * 2) {
            showTranslationError(lang);
        }
    }

    attempt();
}

/* Use safeTranslate instead of old doGTranslate */
function doGTranslate(lang) {
    safeTranslate(lang);
}

/* ---------- 5. Verify translation (content check) ---------- */
function verifyTranslation(lang) {
    if (lang === "en") return;

    const sample = document.body.innerText.slice(0, 600).toLowerCase();
    const markers = [" warranty ", " support ", " product ", " bonniebyte "];

    const translated = !markers.some(m => sample.includes(m));

    if (!translated) {
        setTimeout(() => {
            const check = document.body.innerText.slice(0, 600).toLowerCase();
            const ok = !markers.some(m => check.includes(m));
            if (!ok) showTranslationError(lang);
        }, 800);
    }
}

/* ---------- 6. Error banner ---------- */
function showTranslationError(lang) {
    // If user previously disabled the message, skip
    try {
        if (BBCookies.get("bb_hide_translate_error") === "1") return;
    } catch(e){}

    // Do not duplicate banner
    if (document.getElementById("translation-error-banner")) return;

    // Detect iOS Safari
    const ua = navigator.userAgent || navigator.vendor || window.opera;
    const isIOS = /iPad|iPhone|iPod/.test(ua);
    const isSafari = /^((?!chrome|android).)*safari/i.test(ua);
    const isIOSSafari = isIOS && isSafari;

    const iosLine = isIOSSafari
        ? `<span style="opacity:0.8; font-size:0.8rem;">iOS Safari may block translation occasionally.</span>`
        : ``;

    // Create banner
    const banner = document.createElement("div");
    banner.id = "translation-error-banner";
    banner.style.position = "fixed";
    banner.style.bottom = "20px";
    banner.style.left = "50%";
    banner.style.transform = "translateX(-50%)";
    banner.style.background = "rgba(0,0,0,0.88)";
    banner.style.border = "2px solid #66aaff";
    banner.style.padding = "14px 18px";
    banner.style.borderRadius = "10px";
    banner.style.color = "#fff";
    banner.style.zIndex = "999999";
    banner.style.fontSize = "0.9rem";
    banner.style.boxShadow = "0 0 14px rgba(102,170,255,0.55)";
    banner.style.fontFamily = "Inter, sans-serif";
    banner.style.display = "flex";
    banner.style.gap = "18px";
    banner.style.alignItems = "center";
    banner.style.maxWidth = "90%";
    banner.style.flexWrap = "wrap";

    banner.innerHTML = `
        <div style="display:flex; flex-direction:column; line-height:1.25; flex:1;">
            <span>Automatic translation is temporarily unavailable.</span>
            ${iosLine}
            <label style="margin-top:6px; font-size:0.78rem; opacity:0.9;">
                <input type="checkbox" id="bb-hide-msg" style="margin-right:6px;">
                Don't show this again
            </label>
        </div>

        <button id="retry-translate" style="
            background:#66aaff; color:#000; border:none;
            padding:6px 12px; border-radius:6px; cursor:pointer;
            font-size:0.85rem; font-weight:600;">
            Retry
        </button>

        <button id="bb-close-translate-banner" style="
            background:none; border:none; color:#fff;
            font-size:1.2rem; cursor:pointer; padding:4px;">
            ✕
        </button>
    `;

    document.body.appendChild(banner);

    // Close function shared by both interactions
    function closeBanner() {
        const hide = document.getElementById("bb-hide-msg").checked;
        if (hide) {
            try {
                BBCookies.set("bb_hide_translate_error", "1", 365);
            } catch(e){}
        }

        banner.style.opacity = "0";
        banner.style.transition = "opacity 0.35s ease";
        setTimeout(() => banner.remove(), 350);
    }

    // Retry button behaviour
    document.getElementById("retry-translate").onclick = () => {
        closeBanner();

        let last = lang;
        try { last = BBCookies.get("bb_lang") || lang; } catch(e){}
        safeTranslate(last);
    };

    // Close button behaviour
    document.getElementById("bb-close-translate-banner").onclick = closeBanner;

    // Auto-hide after 12 seconds unless user hovered or interacted
    setTimeout(() => {
        if (document.getElementById("translation-error-banner")) {
            closeBanner();
        }
    }, 12000);
}
</script>

<!-- Google Script Loader -->
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script>
/* KEEP THIS — hides Google banner */
function hideGoogleBar() {
    const frame = document.querySelector("iframe.goog-te-banner-frame");
    if (frame) frame.style.display = "none";
    const skip = document.querySelector(".skiptranslate");
    if (skip) skip.style.display = "none";
    document.documentElement.style.top = "0px";
}

setInterval(hideGoogleBar, 200);
window.addEventListener("load", hideGoogleBar);
</script>

</footer>
